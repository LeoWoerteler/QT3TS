<?xml version="1.0" encoding="us-ascii"?>
<test-set xmlns="http://www.w3.org/2010/09/qt-fots-catalog" name="prod-VersionDecl">
   <description>Tests for the VersionDecl production</description>
   <link type="spec" document="http://www.w3.org/TR/xquery-30/"
         idref="doc-xquery30-VersionDecl"/>
   <link type="spec" document="XQuery" section-number="4.1"
         idref="id-version-declaration"/>
         
   <environment name="bib2">
      <source role="." file="../op/union/bib2.xml">
         <description>Bibliography example with extra comments and PIs.</description>
         <created by="spec-authors" on="2000-01-01"/>
      </source>
   </environment>    
         
   <dependency type="spec" value="XQ10+"/>      

   <test-case name="version_declaration-001">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <modified by="O'Neil Delpratt" on="2012-05-23" change="Bug fix related to bug #14955"/>
      <test>xquery version "1.0" (:encoding "utf-8xx":); 1,2</test>
      <result>
          <any-of>
            <assert-string-value>1 2</assert-string-value>
            <error code="*"/>
          </any-of>
      </result>
   </test-case>

   <test-case name="version_declaration-002">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <dependency type="spec" value="XQ10+"/>
      <modified by="O'Neil Delpratt" on="2012-05-23" change="Bug fix related to bug #14955"/>
      <test><![CDATA[(:encoding "utf-8xx":)xquery version "1.0"; <bib/>]]></test>
      <result>
          <any-of>
             <assert-xml><![CDATA[<bib/>]]></assert-xml>
             <error code="*"/>
          </any-of>
      </result>
   </test-case>

   <test-case name="version_declaration-003">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <modified by="O'Neil Delpratt" on="2012-05-23" change="Bug fix related to bug #14955"/>
      <environment ref="bib2"/>
      <test>(:encoding "abc":)xquery version '1.0'; declare boundary-space preserve; declare default order empty greatest; declare namespace ns = "http://www.example.org/"; declare variable $input-context external; for $b in $input-context//book stable order by xs:decimal($b/price) empty greatest return $b/title</test>
      <result>
          <any-of>
                <assert-xml><![CDATA[<title>Data on the Web</title><title>TCP/IP Illustrated</title><title>Advanced Programming in the Unix environment</title><title>The Economics of Technology and Content for Digital TV</title>]]></assert-xml>
                <error code="*"/>
          </any-of>
      </result>
   </test-case>

   <test-case name="version_declaration-004">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <modified by="O'Neil Delpratt" on="2012-05-23" change="Bug fix related to bug #14955"/>
      <environment ref="bib2"/>
      <test>(:encoding "abc":)xquery version "1.0"; declare boundary-space preserve; declare default order empty greatest; declare namespace ns = "http://www.example.org/"; declare variable $input-context external; for $b in $input-context//book stable order by xs:decimal($b/price) empty greatest return $b/title</test>
      <result>
          <any-of>
            <assert-xml><![CDATA[<title>Data on the Web</title><title>TCP/IP Illustrated</title><title>Advanced Programming in the Unix environment</title><title>The Economics of Technology and Content for Digital TV</title>]]></assert-xml>
            <error code="*"/>
          </any-of>
      </result>
   </test-case>

   <test-case name="version_declaration-006">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <modified by="O'Neil Delpratt" on="2012-05-23" change="Bug fix related to bug #14955"/>
      <dependency type="spec" value="XQ10"/>
      <test><![CDATA[xquery version "3.0"; <bib/>]]></test>
      <result>
            <error code="XQST0031"/>
      </result>
   </test-case>

       <test-case name="version_declaration-006a">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="O'Neil Delpratt" on="2012-05-23" change="Bug fix related to bug #14955: Added dependenct XQ30+"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[xquery version "3.0"; <bib/>]]></test>
      <result>
          <assert-xml><![CDATA[<bib/>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="version_declaration-007">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <test>xquery version '-1.0'; 2 + 2</test>
      <result>
         <error code="XQST0031"/>
      </result>
   </test-case>

   <test-case name="version_declaration-008">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <test>xquery version "abc"; 1,2</test>
      <result>
         <error code="XQST0031"/>
      </result>
   </test-case>

   <test-case name="version_declaration-009">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <test>declare boundary-space preserve; xquery version "1.0"; 1,2</test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>

   <test-case name="version_declaration-010">
      <description>Evaluation of version declaration, for which the encoding does not conforms to "encName" from XML 1.0. </description>
      <created by="Carmelo Montanez" on="2005-02-06"/>
      <test>xquery version "1.0" encoding "999-UTF-8-*"; "ABC"</test>
      <result>
         <error code="XQST0087"/>
      </result>
   </test-case>

   <test-case name="prolog-version-1">
      <description> Prolog version declaration with both version and encoding information (set to 1.0 and "utf-8" respectively. </description>
      <created by="Carmelo Montanez" on="2006-02-15"/>
      <test>xquery version "1.0" encoding "utf-8"; 1,2</test>
      <result>
         <assert-string-value>1 2</assert-string-value>
      </result>
   </test-case>

   <test-case name="prolog-version-3">
      <description> Prolog version declaration with both version and encoding information (set to 1.0 and "US-ASCII" respectively. </description>
      <created by="Carmelo Montanez" on="2006-02-15"/>
      <test>xquery version "1.0" encoding "US-ASCII"; 1,2</test>
      <result>
         <assert-string-value>1 2</assert-string-value>
      </result>
   </test-case>

   <test-case name="prolog-version-4">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Carmelo Montanez" on="2006-02-15"/>
      <test>xquery version "1.0"; 1,2</test>
      <result>
         <assert-string-value>1 2</assert-string-value>
      </result>
   </test-case>

   <test-case name="prolog-version-5">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Carmelo Montanez" on="2006-02-15"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[xquery version "1.0"; <bib/>]]></test>
      <result>
         <assert-xml><![CDATA[<bib/>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="prolog-version-6">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Carmelo Montanez" on="2006-02-15"/>
      <environment ref="bib2"/>
      <test>
        xquery version '1.0'; 
        declare boundary-space preserve; 
        declare default order empty greatest; 
        declare namespace ns = "http://www.example.org/"; 
        for $b in//book stable order by xs:decimal($b/price[1]) empty greatest 
        return $b/title</test>
      <result>
         <assert-xml><![CDATA[<title>Data on the Web</title><title>TCP/IP Illustrated</title><title>Advanced Programming in the Unix environment</title><title>The Economics of Technology and Content for Digital TV</title>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="prolog-version-7">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Carmelo Montanez" on="2006-02-15"/>
      <environment ref="bib2"/>
      <test>
        xquery version "1.0"; 
        declare boundary-space preserve; 
        declare default order empty greatest; 
        declare namespace ns = "http://www.example.org/"; 
        for $b in //book stable order by xs:decimal($b/price[1]) empty greatest 
        return $b/title</test>
      <result>
         <assert-xml><![CDATA[<title>Data on the Web</title><title>TCP/IP Illustrated</title><title>Advanced Programming in the Unix environment</title><title>The Economics of Technology and Content for Digital TV</title>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="prolog-version-9">
      <description>Written By: Carmelo Montanez  
        Demonstrates version declaration,the version declaration occurs at the beginning of the module 
        and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Pulkita Tyagi" on="2006-02-15"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[xquery version "3.0"; <bib/>]]></test>
      <result>
         <any-of>
            <assert-xml><![CDATA[<bib/>]]></assert-xml>
            <error code="XQST0031"/>
         </any-of>
      </result>
   </test-case>

   <test-case name="prolog-version-10">
      <description>Written By: Carmelo Montanez  Demonstrates version declaration,the version declaration occurs at 
        the beginning of the module and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Pulkita Tyagi" on="2006-02-15"/>
      <test>xquery version '-1.0'; 2 + 2</test>
      <result>
         <error code="XQST0031"/>
      </result>
   </test-case>

   <test-case name="prolog-version-11">
      <description>Written By: Carmelo Montanez  Demonstrates version declaration,the version declaration occurs at 
        the beginning of the module and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Pulkita Tyagi" on="2006-02-15"/>
      <test>xquery version "abc"; 1,2</test>
      <result>
         <error code="XQST0031"/>
      </result>
   </test-case>

   <test-case name="prolog-version-12">
      <description>Written By: Carmelo Montanez  Demonstrates version declaration,the version declaration occurs at 
        the beginning of the module and identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Pulkita Tyagi" on="2006-02-15"/>
      <test>declare boundary-space preserve; xquery version "1.0"; 1,2</test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>

   <test-case name="K-VersionProlog-1">
      <description> A simple version declaration including encoding. Since it's implementation defined how comments 
        before the version declaration is handled, any error is allowed. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>(:encoding "UTF-8XX":)xquery version "1.0" encoding "UTF-8"; 1 eq 1</test>
      <result>
          <any-of>
            <assert-true/>
            <error code="*"/>
          </any-of>
      </result>
   </test-case>

   <test-case name="K-VersionProlog-2">
      <description> A simple version declaration excluding encoding. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>xquery version "1.0" ; 1 eq 1</test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="K-VersionProlog-3">
      <description> A version declaration with an encoding containing whitespace. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>xquery version "1.0" encoding "UTF-8 "; 1</test>
      <result>
         <error code="XQST0087"/>
      </result>
   </test-case>

   <test-case name="K-VersionProlog-4">
      <description> A version declaration with an encoding containing an disallowed character. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>xquery version "1.0" encoding "ISO-8859-1|"; 1</test>
      <result>
         <error code="XQST0087"/>
      </result>
   </test-case>

   <test-case name="K-VersionProlog-5">
      <description> A prolog containing many different declarations. TODO function declarations missing TODO variable declarations missing </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>
        xquery version "1.0" encoding "ISO-8859-1"; 
        declare boundary-space preserve; 
        declare default collation "http://www.w3.org/2005/xpath-functions/collation/codepoint"; 
        declare base-uri "http://example.com/"; 
        declare construction strip; 
        declare ordering ordered; 
        declare default order empty greatest; 
        declare copy-namespaces no-preserve, no-inherit; 
        declare namespace ex = "http://example.com/a/Namespace"; 
        declare default element namespace "http://example.com/"; 
        declare default function namespace "http://example.com/"; 
        declare option fn:x-notRecognized "option content"; 
        1 eq 1</test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="K2-VersionProlog-1">
      <description> a string literal reminding of an xquery version declaration. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>'xquery version "1.0" encoding "UTF-8|#%";' eq 'xquery version "1.0" encoding "UTF-8|#%";'</test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="K2-VersionProlog-2">
      <description> a string literal reminding of an xquery version declaration. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>"xquery version '1.0' encoding 'UTF-8|#%';" eq "xquery version '1.0' encoding 'UTF-8|#%';"</test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="K2-VersionProlog-3">
      <description> Use an invalid keyword as encoding. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>xquery version "1.0" default; 1</test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>

   <test-case name="K2-VersionProlog-4">
      <description> Whitespace isn't allowed after a prefix in a QName. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>encoding :localName</test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>

   <test-case name="K2-VersionProlog-5">
      <description> Check that the 'xquery' name test is parsed correctly. </description>
      <created by="Frans Englich" on="2007-11-26"/>
      <test>xquery gt xquery</test>
      <result>
         <error code="XPDY0002"/>
      </result>
   </test-case>
   
   <test-case name="version_declaration-005">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module and 
      identifies the applicable XQuery syntax and semantics for the module </description>
      <created by="Pulkita Tyagi" on="2005-10-05"/>
      <dependency type="feature" value="schemaImport"/>
      <test>
        xquery version "1.0"; 
        declare boundary-space preserve; 
        declare default collation "xspanish"; 
        declare base-uri "http://www.base-uri.com/"; 
        declare construction strip; declare ordering unordered; 
        declare default order empty greatest; 
        import schema default element namespace "http://comment"; 
        declare namespace foo = "http://foo.org"; 
        declare default function namespace "http://example.org/math-functions"; 
        declare namespace bar = "http://bar.org"; 
        declare variable $x as xs:integer := 7; 
        declare function local:sumOf1toN($i) as xs:integer { if ($i = 1) then $i else $i + local:sumOf1toN($i - 1) }; 
        declare option foo:strip-comments "true"; 
        local:sumOf1toN(5)</test>
      <result>
         <any-of>
            <assert-eq>15</assert-eq>
            <error code="XQST0038"/>
            <error code="XQST0059"/>
         </any-of>
      </result>
   </test-case>

   <test-case name="prolog-version-8">
      <description> Demonstrates version declaration,the version declaration occurs at the beginning of the module and 
      identifies the applicable XQuery syntax and semantics for the module. </description>
      <created by="Carmelo Montanez" on="2006-02-15"/>
      <dependency type="feature" value="schemaImport"/>
      <test>
        xquery version "1.0"; 
        declare boundary-space preserve; 
        declare default collation "xhttp://example.org/languages/spanish"; 
        declare base-uri "http://www.base-uri.com/"; 
        declare construction strip; 
        declare ordering unordered; 
        declare default order empty greatest; 
        import schema default element namespace "http://comment" at "comment.xsd"; 
        declare namespace foo = "http://foo.org"; 
        declare default function namespace "http://example.org/math-functions"; 
        declare namespace bar = "http://bar.org"; 
        declare variable $x as xs:integer := 7; 
        declare function local:sumOf1toN($i) as xs:integer { if ($i = 1) then $i else $i + local:sumOf1toN($i - 1) }; 
        declare option foo:strip-comments "true"; 
        local:sumOf1toN(5)</test>
      <result>
         <any-of>
            <assert-eq>15</assert-eq>
            <error code="XQST0038"/>
            <error code="XQST0059"/>
         </any-of>
      </result>
   </test-case>
      
</test-set>